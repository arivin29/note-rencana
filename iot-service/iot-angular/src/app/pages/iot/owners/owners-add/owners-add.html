<div class="d-flex align-items-center mb-3">
  <div>
    <ul class="breadcrumb mb-1">
      <li class="breadcrumb-item"><a href="javascript:;">IoT</a></li>
      <li class="breadcrumb-item"><a routerLink="/iot/owners">Owners</a></li>
      <li class="breadcrumb-item active">Create</li>
    </ul>
    <h1 class="page-header mb-0">Create Owner</h1>
  </div>
  <div class="ms-auto">
    <a routerLink="/iot/owners" class="btn btn-outline-default">Back</a>
  </div>
</div>

<form (ngSubmit)="submitOwner()" #ownerForm="ngForm">
  <!-- Success Alert -->
  <div *ngIf="successMessage" class="alert alert-success alert-dismissible fade show mb-3" role="alert">
    <i class="fa fa-check-circle me-2"></i>
    {{ successMessage }}
  </div>

  <!-- Error Alert -->
  <div *ngIf="error" class="alert alert-danger alert-dismissible fade show mb-3" role="alert">
    <i class="fa fa-exclamation-circle me-2"></i>
    {{ error }}
    <button type="button" class="btn-close" (click)="error = null"></button>
  </div>

  <card>
    <card-body>
      <div class="row g-3">
        <div class="col-md-6">
          <label class="form-label">Owner Name <span class="text-danger">*</span></label>
          <input class="form-control" placeholder="PT ABC" [(ngModel)]="form.name" name="name" required>
        </div>
        <div class="col-md-6">
          <label class="form-label">Industry</label>
          <select class="form-select" [(ngModel)]="form.industry" name="industry">
            <option *ngFor="let option of industryOptions" [value]="option">{{ option }}</option>
          </select>
        </div>
        <div class="col-md-4">
          <label class="form-label">Contact Person <span class="text-danger">*</span></label>
          <input class="form-control" [(ngModel)]="form.contactPerson" name="contactPerson" required>
        </div>
        <div class="col-md-4">
          <label class="form-label">Contact Email</label>
          <input type="email" class="form-control" [(ngModel)]="form.contactEmail" name="contactEmail">
        </div>
        <div class="col-md-4">
          <label class="form-label">Contact Phone</label>
          <input class="form-control" [(ngModel)]="form.contactPhone" name="contactPhone">
        </div>
        <div class="col-md-4">
          <label class="form-label">SLA Level</label>
          <select class="form-select" [(ngModel)]="form.slaLevel" name="slaLevel">
            <option *ngFor="let sla of slaLevels" [value]="sla">{{ sla | titlecase }}</option>
          </select>
        </div>
        <div class="col-12">
          <label class="form-label">Address</label>
          <textarea class="form-control" rows="2" [(ngModel)]="form.address" name="address"></textarea>
        </div>
        <div class="col-12">
          <label class="form-label">Notes</label>
          <textarea class="form-control" rows="2" [(ngModel)]="form.notes" name="notes"></textarea>
        </div>
        
        <!-- Forwarding Settings -->
        <div class="col-12 mt-4">
          <h6 class="mb-3">Data Forwarding Settings</h6>
        </div>
        <div class="col-md-4">
          <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" [(ngModel)]="form.enableWebhook" name="enableWebhook" id="enableWebhook">
            <label class="form-check-label" for="enableWebhook">Enable Webhook</label>
          </div>
        </div>
        <div class="col-md-8">
          <label class="form-label">Webhook URL</label>
          <input class="form-control" placeholder="https://api.example.com/webhook" 
                 [(ngModel)]="form.webhookUrl" name="webhookUrl"
                 [disabled]="!form.enableWebhook">
        </div>
        <div class="col-md-4">
          <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" [(ngModel)]="form.enableDatabase" name="enableDatabase" id="enableDatabase">
            <label class="form-check-label" for="enableDatabase">Enable Database Storage</label>
          </div>
        </div>
        <div class="col-md-4">
          <label class="form-label">Batch Size</label>
          <input type="number" class="form-control" [(ngModel)]="form.batchSize" name="batchSize" min="1" max="1000">
          <small class="text-muted">Number of records per batch (1-1000)</small>
        </div>
      </div>
    </card-body>
  </card>

  <div class="row g-3 mt-3">
    <div class="col-lg-6">
      <card>
        <card-body>
          <div class="fw-semibold mb-2">Owner Summary</div>
          <div class="text-muted small">{{ form.name || 'Owner Name' }}</div>
          <div class="text-muted small">Industry: {{ form.industry }}</div>
          <div class="text-muted small">Contact: {{ form.contactPerson || '-' }}</div>
          <div class="text-muted small">Email: {{ form.contactEmail || '-' }}</div>
          <div class="text-muted small">Phone: {{ form.contactPhone || '-' }}</div>
        </card-body>
      </card>
    </div>
    <div class="col-lg-6">
      <card>
        <card-body>
          <div class="d-flex align-items-center mb-2">
            <div class="fw-semibold">Payload Preview</div>
            <div class="ms-auto text-muted small">Demo JSON</div>
          </div>
          <pre class="bg-dark text-white rounded-3 p-3 small mb-0">{{ payload | json }}</pre>
        </card-body>
      </card>
    </div>
  </div>

  <div class="d-flex justify-content-end mt-3">
    <button type="submit" class="btn btn-theme" [disabled]="!ownerForm.form.valid">
      <i class="fa fa-save fa-fw me-1"></i>
      Save Owner
    </button>
  </div>
</form>
