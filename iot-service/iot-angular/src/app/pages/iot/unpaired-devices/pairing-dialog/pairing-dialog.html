<div class="modal-header">
  <h5 class="modal-title">
    <i class="fa fa-link me-2"></i>
    Pair Device: {{ deviceInfo }}
  </h5>
  <button type="button" class="btn-close" (click)="cancel()"></button>
</div>

<div class="modal-body">
  <div class="alert alert-info mb-4">
    <div class="row g-3">
      <div class="col-md-4">
        <small class="text-muted d-block">Hardware ID</small>
        <strong>{{ device.hardwareId }}</strong>
      </div>
      <div class="col-md-4">
        <small class="text-muted d-block">Last Seen</small>
        <strong>{{ device.lastSeenAt | date: 'medium' }}</strong>
      </div>
      <div class="col-md-4">
        <small class="text-muted d-block">Seen Count</small>
        <strong>{{ device.seenCount }} times</strong>
      </div>
    </div>
  </div>

  <div *ngIf="error" class="alert alert-danger d-flex align-items-center">
    <i class="fa fa-triangle-exclamation me-2"></i>
    <div>{{ error }}</div>
  </div>

  <div class="mb-3">
    <label class="form-label">Project <span class="text-danger">*</span></label>
    <select class="form-select" [(ngModel)]="projectId" [disabled]="loadingProjects" required>
      <option value="">-- Select Project --</option>
      <option *ngFor="let project of projects" [value]="project.idProject">
        {{ project.name }}
      </option>
    </select>
    <small class="text-muted" *ngIf="loadingProjects">
      <i class="fa fa-spinner fa-spin me-1"></i>
      Loading projects...
    </small>
    <small class="text-muted" *ngIf="!loadingProjects && projectId">
      <i class="fa fa-lightbulb text-warning me-1"></i>
      Pair with the selected project.
    </small>
  </div>

  <div class="mb-3">
    <label class="form-label">Node Name <span class="text-danger">*</span></label>
    <input class="form-control" [(ngModel)]="nodeName" maxlength="120" />
    <small class="text-muted">Defaults to the detected hardware label but you can adjust it.</small>
  </div>

  <div class="mb-3">
    <label class="form-label">Description</label>
    <textarea class="form-control" rows="3" [(ngModel)]="nodeDescription"></textarea>
    <small class="text-muted">Optional description shown on the paired node.</small>
  </div>
</div>

<div class="modal-footer">
  <button type="button" class="btn btn-outline-secondary" (click)="cancel()">Cancel</button>
  <button type="button" class="btn btn-primary" (click)="pairDevice()" [disabled]="loading || !canPair">
    <span *ngIf="!loading"><i class="fa fa-link me-1"></i>Pair Device</span>
    <span *ngIf="loading"><span class="spinner-border spinner-border-sm me-1"></span>Pairing...</span>
  </button>
</div>
