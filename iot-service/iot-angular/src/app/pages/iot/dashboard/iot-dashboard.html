<div class="telemetry-console">
    <card class="console-panel filter-panel mb-4">
        <card-body>
            <div class="filter-header">
                <div>
                    <div class="panel-label">Control Filters</div>
                    <div class="panel-hint text-muted">Refine owners, projects, and time slices</div>
                </div>
                <div class="filter-chips">
                    <span class="filter-chip">Owner · {{ getOwnerLabel() }}</span>
                    <span class="filter-chip">Project · {{ getProjectLabel() }}</span>
                    <span class="filter-chip">Range · {{ getRangeLabel() }}</span>
                </div>
            </div>
            <div class="row g-3 align-items-end">
                <div class="col-xl-4 col-md-6">
                    <div class="filter-control">
                        <label class="filter-label">Owner</label>
                        <div class="filter-input">
                            <i class="bi bi-people"></i>
                            <select class="form-select form-select-sm console-select" [ngModel]="selectedOwner"
                                (ngModelChange)="setFilter('owner', $event)">
                                <option *ngFor="let option of ownerFilterOptions" [ngValue]="option.value">{{
                                    option.label }}</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="col-xl-4 col-md-6">
                    <div class="filter-control">
                        <label class="filter-label">Project</label>
                        <div class="filter-input">
                            <i class="bi bi-diagram-3"></i>
                            <select class="form-select form-select-sm console-select" [ngModel]="selectedProject"
                                (ngModelChange)="setFilter('project', $event)">
                                <option *ngFor="let option of projectFilterOptions" [ngValue]="option.value">{{
                                    option.label }}</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="col-xl-4 col-12">
                    <div class="filter-control">
                        <label class="filter-label">Time Range</label>
                        <div class="filter-input">
                            <i class="bi bi-clock-history"></i>
                            <select class="form-select form-select-sm console-select" [ngModel]="selectedRange"
                                (ngModelChange)="setFilter('range', $event)">
                                <option *ngFor="let option of timeRangeOptions" [ngValue]="option.value">{{ option.label
                                    }}</option>
                            </select>
                        </div>
                        <div class="filter-hint small text-muted mt-2">
                            {{ getRangeLabel() }} · {{ getOwnerLabel() }} · {{ getProjectLabel() }}
                        </div>
                    </div>
                </div>
            </div>
            <div class="filter-footer">
                <div class="text-muted small">Filters apply to all widgets, including telemetry and health tables.</div>
                <button class="btn btn-outline-theme btn-sm" (click)="resetFilters()">Reset Filters</button>
            </div>
        </card-body>
    </card>

    <!-- KPI Cards Widget -->
    <dashboard-kpi-cards 
        [ownerId]="dashboardFilters.ownerId"
        [projectId]="dashboardFilters.projectId"
        [timeRange]="dashboardFilters.timeRange">
    </dashboard-kpi-cards>

 
    <div class="row g-3 mt-1">
        <!-- Node Health Widget -->
        <div class="col-md-6">
            <dashboard-node-health 
                [ownerId]="dashboardFilters.ownerId"
                [projectId]="dashboardFilters.projectId"
                [timeRange]="dashboardFilters.timeRange"
                [limit]="5">
            </dashboard-node-health>
        </div>

        <!-- Owner Leaderboard Widget -->
        <div class="col-md-6">
            <dashboard-owner-leaderboard 
                [timeRange]="dashboardFilters.timeRange"
                [limit]="10">
            </dashboard-owner-leaderboard>
        </div>
    </div>

    <!-- Activity Log & Release Window Row -->
    <div class="row g-3 mt-1">
        <div class="col-xl-6">
            <dashboard-activity-log 
                [ownerId]="dashboardFilters.ownerId"
                [projectId]="dashboardFilters.projectId"
                [timeRange]="dashboardFilters.timeRange"
                [limit]="10">
            </dashboard-activity-log>
        </div>
        <div class="col-xl-6">
            <dashboard-release-window></dashboard-release-window>
        </div>
    </div>

    <!-- Telemetry Streams & Delivery/Alerts Row -->
    <div class="row g-3 mt-1 align-items-stretch">
        <div class="col-md-8">
            <dashboard-telemetry-streams 
                [ownerId]="dashboardFilters.ownerId"
                [projectId]="dashboardFilters.projectId"
                [timeRange]="dashboardFilters.timeRange">
            </dashboard-telemetry-streams>
        </div>
        <div class="col-md-4">
            <dashboard-delivery-health 
                [ownerId]="dashboardFilters.ownerId"
                [timeRange]="dashboardFilters.timeRange"
                class="d-block mb-3">
            </dashboard-delivery-health>
    
            <dashboard-alert-stream 
                [ownerId]="dashboardFilters.ownerId"
                [projectId]="dashboardFilters.projectId"
                [limit]="10">
            </dashboard-alert-stream>
        </div>
    </div>

    
</div>